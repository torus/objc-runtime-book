## メソッド呼び出し

Objective-C では、ほとんどの操作がメソッド呼び出しの形で記述されます。このメソッド呼び出しの記法は C に対する言語の拡張です。以下で Objective-C の基本的な書き方をおさらいしましょう。

オブジェクトに対してメソッドを呼び出すには、例えば次のように書きます：

```objc
NSString *str = @"Hello";
NSString *newStr = [str substringFromIndex: 1];
```

この例ではまず `str` という名前の NSString オブジェクトを作った上で、これに対して `substringFromIndex:` というメソッドを呼び出しています。この場合は引数は 1 個で 1 という値を渡しています。メソッドの戻り値は `newStr` という変数に格納されます。

引数が 2 個の場合は次のような形式で呼び出します：

```objc
NSString *replaced = [str stringByReplacingOccurrencesOfString: @"e" withString: @"a"];
```

API のリファレンスマニュアルでは、このメソッドは `stringByReplacingOccurrencesOfString:withString:` という項目として掲載されています。このように途中に `:` を含むような形式がメソッドの名前となります。また、逆にこのメソッド名には 2 個の `:` が含まれることから、メソッド名を見ただけで引数を 2 個とるメソッドであることがわかります。


## objc_msgSend

さて、次にこれを同様のメソッド呼び出しを Objective-C ランタイム API を使って実現しましょう。これは C の API なので、通常の C の関数呼び出しの形をしています。オブジェクトに対してメソッドを呼び出すには `objc_msgSend` という関数を使います。上の最初の例でとりあげたメソッドは次のように書けます：

```objc
NSString *newStr = objc_msgSend(str, @selector(substringFromIndex:), 1);
```

第 1 引数は対象となるオブジェクトです。その次の引数は特殊な形をしていますが、これはメソッドの*セレクタ*を取得するための構文です。詳細はこの後で説明します。最後の引数はメソッドの引数です。

## セレクタ

メソッドのセレクタとは、それぞれのメソッド名につけられたユニークな ID のようなものです。上のコードでは `@selector` という特殊な形式の構文を使っていますが、次のように純粋に C の関数呼び出しだけを用いて記述することもできます。

```objc
SEL sel = sel_registerName("substringFromIndex:");
NSString *newStr = objc_msgSend(str, sel, 1);
```
